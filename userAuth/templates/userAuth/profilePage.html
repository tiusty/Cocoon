{% extends "bootstrapJQuery.html" %}
{% load static %}
{% block title %}Profile Page{% endblock %}


{% block head %}
    {{ block.super }}
    <!-- Custom StyleSheets -->
    <link rel="stylesheet" href="{% static 'userAuth/profilePage.css' %}">
{% endblock %}


{% block content %}

<div class="row">
    <div class="col-sm-12">
        {% if error_message %}
            <div class="row">
                <div class="col-sm-offset-3 col-sm-6" style="color:red">
                    <p><strong>{{ error_message }}</strong></p>
                </div>
            </div>
        {% endif %}

    </div>
</div>
<div class="row">
    <div class="col-lg-12 col-sm-6">
        <div class="card hovercard">
            <div class="card-background">
                <img class="card-bkimg" alt="" src="http://lorempixel.com/100/100/people/9/">
                <!-- http://lorempixel.com/850/280/people/9/ -->
            </div>
            <div class="useravatar">
                <img alt="" src="http://lorempixel.com/100/100/people/9/">
            </div>
            <div class="card-info"><span class="card-title">{{ userProfile.user.get_full_name }}</span>

            </div>
        </div>
        <div class="btn-pref btn-group btn-group-justified btn-group-lg" role="group" aria-label="...">
            <div class="btn-group" role="group">
                <button type="button" id="stars"
                        {% if defaultProfile == 0 %}
                        class="btn btn-primary"
                        {% else %}
                        class="btn btn-default"
                        {% endif %}
                        href="#tab1" data-toggle="tab"><span
                        class="glyphicon glyphicon-user" aria-hidden="true"></span>
                    <div class="hidden-xs">Profile</div>
                </button>
            </div>
            <div class="btn-group" role="group">
                <button type="button" id="favorites"
                        {% if defaultProfile == 1 %}
                        class="btn btn-primary"
                        {% else %}
                        class="btn btn-default"
                        {% endif %}
                        href="#tab2" data-toggle="tab"><span
                        class="glyphicon glyphicon-heart" aria-hidden="true"></span>
                    <div class="hidden-xs">Rent Surveys</div>
                </button>
            </div>
            <div class="btn-group" role="group">
                <button type="button" id="following"
                        {% if defaultProfile == 2 %}
                        class="btn btn-primary"
                        {% else %}
                        class="btn btn-default"
                        {% endif %}
                        href="#tab3" data-toggle="tab"><span
                        class="glyphicon glyphicon-home" aria-hidden="true"></span>
                    <div class="hidden-xs">Buying Surveys</div>
                </button>
            </div>
        </div>

        <div class="well">
            <div class="tab-content">
                {% if defaultProfile == 0 %}
                    <div class="tab-pane fade in active" id="tab1">
                {% else %}
                    <div class="tab-pane fade in" id="tab1">
                {% endif %}
                <div class="row">
                    <h3 class="col-sm-12">Account Setting</h3>
                    <div class="col-sm-9 col-sm-offset-3">
                        <form class="form-horizontal" action="{% url 'userAuth:profilePage' 'profile' %}"
                              method="POST">
                            {% csrf_token %}
                            <div class="form-group">
                                {{ form.as_p }}
                            </div>
                            <p>Number of Rent Surveys: {{ numRentSurveys }}</p>
                            <p>Number of Buy Surveys: {{ numBuySurveys }}</p>
                            <div class="form-group">
                                <button type="submit" id="Submit" class="btn btn-primary">Save Changes!</button>
                            </div>
                        </form>
                    </div>
                </div>
                </div>
                {% if defaultProfile == 1 %}
                    <div class="tab-pane fade in active" id="tab2">
                {% else %}
                    <div class="tab-pane fade in" id="tab2">
                {% endif %}
                <div class="panel-group" id="accordion_rent">
                    {% for survey in surveys %}
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a data-toggle="collapse" data-parent="#accordion_rent"
                                       href="#collapse{{ forloop.counter }}">
                                        <h4><b>Survey Name: {{ survey.name }}</b></h4></a>
                                </h4>
                            </div>
                            <div id="collapse{{ forloop.counter }}"
                                 class="panel-collapse collapse {% if forloop.counter == 1 %}in{% endif %}">
                                <div class="panel-body">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>Addresses</th>
                                            <th>Home_Types</th>
                                            <th>Price Range</th>
                                            <th>Commute Range</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% with survey.rentingdesintations_set.all as destAddresses %}
                                            {% for destAddress in destAddresses %}
                                                <tr>
                                                    <td>
                                                        {{ destAddress.streetAddress }}, {{ destAddress.city }}, {{ destAddress.state }}, {{ destAddress.zip_code }}
                                                    </td>
                                                    {% if forloop.counter == 1 %}
                                                        <td>{{ survey.get_home_types }}</td>
                                                        <td>{{ survey.get_cost_range }}</td>
                                                        <td>{{ survey.get_commute_range }}</td>
                                                    {% endif %}
                                                </tr>
                                            {% endfor %}
                                        {% endwith %}
                                        </tbody>
                                    </table>
                                    <a href="{% url 'survey:surveyResult' survey_type="rent" survey_id=survey.id %}"
                                       class="btn btn-primary active" role="button">Load!</a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                </div>
                {% if defaultProfile == 2 %}
                    <div class="tab-pane fade in active" id="tab3">
                {% else %}
                    <div class="tab-pane fade in" id="tab3">
                {% endif %}
                <h3>Not Implemented yet!</h3>
                </div>
                </div>
                </div>

                </div>
            </div>

{% endblock %}

{% block endScripts %}
{{ block.super }}
        <!-- Custom Javascript -->
        <script src="{% static 'userAuth/profilePage.js' %}"></script>
{% endblock %}