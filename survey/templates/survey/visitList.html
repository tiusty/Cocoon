{% extends "bootstrapJQuery.html" %}
{% load static %}
{% block title %}My Visit List{% endblock %}

{% block head %}
    {{ block.super }}

    <!-- Style sheets for template page -->
    <link href="{% static 'Unicorn/homes/css/homeModal.css' %}" rel="stylesheet">
    <link href="{% static 'survey/survey_result.css' %}" rel="stylesheet">
    {#    <link href="{% static 'survey/survey_result.css' %}" rel="stylesheet">#}

{% endblock %}

{% block content %}


    {% comment %}
        Modal assumes it is being called within a for loop
        This Modal is for the house toggle

    {% for house in user_visit_house_list %}

        {% include "homes/homeModal.html" with modalId="myModalVisit" %}


            This modal creates the delete confirmation dialog for each house
            This also allows the user to delete houses from the user visit list


        <div class="modal fade" id="deleteModal{{ forloop.counter }}"
             tabindex="-1" role="dialog"
             aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"
                                aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">
                            Delete Confirmation</h4>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to delete {{ house.get_address }} from the visit list?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary"
                                data-dismiss="modal">No
                        </button>
                        <button type="button" class="btn btn-danger"
                                onclick="delete_visit_house({{ house.id }}, '{% url 'survey:deleteVisitHouse' %}', '{% url 'survey:visitList' %}')">
                            Yes
                        </button>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}

    {% endcomment %}


    <div class="jumbotron">
        <h1>Your Visit List!</h1>
        <p>Here is your list of homes that you are currently visiting or want to visit</p>
    </div>

    <div class="row">
        <div class="col-md-6">
        <p>The Short List (These are homes you plan on visiting)</p>
            <div class="tileTable">
                {% for house in user_visit_house_list %}
                    {% include "homes/tiles.html" with includeScore=False homeID=house.id homeHouse=house favoriteHouses=user_favorite_houses homeAddress=house.get_full_address homePrice=house.get_price_str housePhotos=house.housephotos_set.all %}
                {% endfor %}
            </div>
        </div>

        <div class="col-md-6">
        <p>Favorites (These are homes you like and want to keep track of)</p>
            <div class="tileTable">
                {% for house in user_favorite_houses %}
                    {% include "homes/tiles.html" with includeScore=False homeID=house.id homeHouse=house favoriteHouses=user_favorite_houses homeAddress=house.get_full_address homePrice=house.get_price_str housePhotos=house.housephotos_set.all %}
                {% endfor %}
            </div>
        </div>
    </div>

    {% comment removing previous table setup %}

    <table class="table table-striped table-hover table-responsive">
        <tbody>
        <thead>
        <tr>
            <th>Toggle</th>
            <th>Home</th>
            <th>Remove Home?</th>
        </tr>
        </thead>

            {% for house in user_visit_house_list %}

            {% endfor %}


        {% for house in user_visit_house_list %}

            <tr>
                <td style="vertical-align:middle">
                    <h3 style="margin-top: 10px;">
                        <span data-toggle="modal" class="accordion-toggle glyphicon glyphicon-plus"
                              data-target="#myModalVisit{{ forloop.counter }}"
                              style="padding-right:1em"></span>
                    </h3>
                </td>
                <td style="vertical-align:middle">
                    {{ house.get_address }}
                </td>
                <td>
                    <button type="button" class="btn btn-danger" data-toggle="modal"
                            data-target="#deleteModal{{ forloop.counter }}">Remove
                    </button>
                </td>
            </tr>
        {% empty %}
            <tr>
                <td>You do not have any homes to visit</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    {% endcomment %}
{% endblock %}

{% block endScripts %}
    {{ block.super }}

    <!-- Custom Javascript -->
    {% comment %}This script enables ajax request by sending the appropriate authentication elements{% endcomment %}
    <script src="{% static 'Unicorn/global_functions/javascript/getCookie.js' %}"></script>
    {% comment %}This script adds the set_visit_house function which enables adding homes to the users visit list{% endcomment %}
    <script src="{% static 'Unicorn/homes/javascript/set_visit_house.js' %}"></script>
    <script src="{% static 'Unicorn/homes/javascript/set_favorite.js' %}"></script>
    {% comment %}This script adds the set_visit_house function which enables removing homes from the users visit list{% endcomment %}
    <script src="{% static 'Unicorn/homes/javascript/delete_visit_house.js' %}"></script>
    {# Necessary imports for the global tiles #}
    <script src="{% static 'survey/tileCarousel.js' %}"></script>
    <script src="{% static 'survey/tileInteraction.js' %}"></script>
    <script src="{% static 'survey/survey_result.js' %}"></script>
    <script src="{% static 'survey/expandTile.js' %}"></script>

{% endblock %}